@startuml th_calibration

skinparam monochrome true

floating note left  
    Porposition modif modelisation

    arena shared var 

    Un seul thread pour le calcul de position et l'envoi d'images 
end note

start

while ( )
    :findArena?;

    :Envoi!STOP;
    note : eventflag 

    :img = Camera.Grab();
    note : assumes function does the mutex part

    :arenaLoc = Img::SearchArena(img);

    if (arena) then (null)
        :msg = new Message(NO_ACK);
        :msgToMon!msg;
    else
        :img = Img::DrawArena(arena);
        :msgToMon!img;
        :arenaValid()?val;
        if(val) then (OK)
            :arena = arenaLoc;
        else (KO)
            :arena = null;
        endif
    endif

    :Envoi!RESUME;


endwhile

stop

@enduml
